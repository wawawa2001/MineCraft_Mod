# ManagerPlugin

## 概要
ManagerPluginは、Minecraftのサーバー上で動作するBukkitプラグインです。本プラグインは以下の機能を提供します。

1. プレイヤー間のチャットログ管理
2. プレイヤーの位置情報取得
3. HTTPサーバーを用いたチャットメッセージの送信
4. 外部からのコマンド実行
5. JSON APIの提供

## 主な機能

### 1. チャットログ管理
- プレイヤーがチャットを送信すると、そのメッセージがメモリ上のキューに保存されます。
- 保存されたチャットログは外部API経由で取得可能です。

### 2. プレイヤーの位置情報取得
- `/gps <player>` コマンドを使用すると、指定したプレイヤーの座標を取得して表示します。
- 例:
  ```
  /gps Steve
  (X, Y, Z) = (100, 65, 200)
  ```

### 3. HTTPサーバーを用いたチャットメッセージ送信
- 外部アプリケーションからチャットメッセージをサーバー内の全プレイヤーに送信できます。
- 使用ポート: `12345`

### 4. 外部からのコマンド実行
- 外部アプリケーションから任意のMinecraftコマンドを実行できます。
- 使用ポート: `12346`

### 5. JSON APIの提供
- サーバーの情報や最新のチャットログをJSON形式で取得できます。
- 使用ポート: `12347`

#### エンドポイント一覧
1. `/get-json`
   - 現在のオンラインプレイヤー数とプレイヤー名を取得します。
2. `/chat-log`
   - 最新10件のチャットログを取得します。

---

## コマンド一覧

### /say <message>
- メッセージを全プレイヤーに送信します。
- 例:
  ```
  /say Hello World!
  ```

### /gps <player>
- 指定したプレイヤーの現在の座標を取得します。

---

## 実装概要

### クラス構成

#### `ManagerPlugin`
- プラグインのメインクラス。全体の初期化とイベント登録を担当。

#### `SayCommand`
- `/say` コマンドの実装クラス。

#### `GPSCommand`
- `/gps` コマンドの実装クラス。

#### `ChatHttpServer`
- 外部からチャットメッセージを送信するためのHTTPサーバーを管理。

#### `CommandSocketThread`
- 外部からMinecraftコマンドを受け取り実行するためのソケット通信を管理。

#### `JsonHttpServer`
- サーバー情報やチャットログを提供するJSON APIサーバーを管理。

---

## インストール方法

1. プラグインをビルドして`ManagerPlugin.jar`を生成します。
2. `ManagerPlugin.jar`をMinecraftサーバーの`plugins`フォルダに配置します。
3. サーバーを起動します。

---

## 使用方法

### 外部からのアクセス

#### 1. チャット送信
- ソケット通信を使用してポート`12345`にメッセージを送信します。

#### 2. コマンド実行
- ソケット通信を使用してポート`12346`にコマンドを送信します。

#### 3. JSON API
- 以下のURLをHTTP GETリクエストで呼び出します。
  - プレイヤー情報: `http://<サーバーIP>:12347/get-json`
  - チャットログ: `http://<サーバーIP>:12347/chat-log`

---

## 注意事項
- 使用するポート番号が他のプロセスで使用されていないことを確認してください。
- 外部からのアクセスにはセキュリティ対策を講じることを推奨します。

---

## 開発環境
- Minecraftサーバー: PaperMCまたはPurpur
- Java: 11以上
- ビルドツール: MavenまたはGradle

---


